CREATE DATABASE QL_NHANVIEN2
USE QL_NHANVIEN2
CREATE TABLE PHONG
(
MAPH CHAR(10) NOT NULL,
TENPH NVARCHAR(40),
 DIADIEM NVARCHAR(50),
 CONSTRAINT PK_PHONG PRIMARY KEY(MAPH)
)
CREATE TABLE CHUCVU
(
MACHUCVU CHAR(20) NOT NULL,
TENCHUCVU NVARCHAR(40),
MAPH CHAR(10) NOT NULL,
CONSTRAINT PK_CHUCVU PRIMARY KEY(MACHUCVU),
CONSTRAINT FK_CHUCVU FOREIGN KEY(MAPH) REFERENCES PHONG(MAPH)
)
CREATE TABLE NHANVIEN
(
MANV CHAR(10) NOT NULL,
HOTEN NVARCHAR(40),
NGAYSINH DATE,
PHAI NVARCHAR(3),
MAPH CHAR(10) NOT NULL,
CONSTRAINT PK_NHANVIEN PRIMARY KEY(MANV),
CONSTRAINT FK_NHANVIEN FOREIGN KEY(MAPH) REFERENCES PHONG(MAPH)
)
CREATE TABLE CONGVIEC
(
MACV CHAR(10) NOT NULL,
MACHUCVU CHAR(20) NOT NULL,
MANV CHAR(10) NOT NULL,
TENCV NVARCHAR(40),
NGAYBD DATE,
NGAYKT DATE,
CONSTRAINT PK_CONGVIEC PRIMARY KEY(MACV,MACHUCVU),
CONSTRAINT FK_CONGVIEC_CHUCVU FOREIGN KEY(MACHUCVU) REFERENCES CHUCVU(MACHUCVU),
CONSTRAINT FK_CONGVIEC_NHANVIEN FOREIGN KEY(MANV) REFERENCES NHANVIEN(MANV)
)

INSERT INTO PHONG (MAPH, TENPH, DIADIEM) VALUES
('P01', N'Phòng Nhân Sự', N'Tầng 1'),
('P02', N'Phòng Kỹ Thuật', N'Tầng 2'),
('P03', N'Phòng Kế Toán', N'Tầng 3');

INSERT INTO CHUCVU (MACHUCVU, TENCHUCVU, MAPH) VALUES
('CV01', N'Trưởng Phòng', 'P01'),
('CV02', N'Nhân Viên', 'P02'),
('CV03', N'Kế Toán Trưởng', 'P03');

INSERT INTO NHANVIEN (MANV, HOTEN, NGAYSINH, PHAI, MAPH) VALUES
('NV01', N'Nguyễn Văn A', '1990-05-12', N'Nam', 'P01'),
('NV02', N'Trần Thị B', '1995-09-20', N'Nữ', 'P02'),
('NV03', N'Lê Văn C', '1988-01-15', N'Nam', 'P03');

INSERT INTO CONGVIEC (MACV, MACHUCVU, MANV, TENCV, NGAYBD, NGAYKT) VALUES
('CV001', 'CV01', 'NV01', N'Quản lý nhân sự', '2023-01-01', '2023-12-31'),
('CV002', 'CV02', 'NV02', N'Sửa chữa hệ thống', '2023-02-01', '2023-10-31'),
('CV003', 'CV03', 'NV03', N'Kiểm toán nội bộ', '2023-03-01', '2023-09-30');

CREATE VIEW CHUCVU_CONGVIEC
AS
SELECT CHUCVU.MACHUCVU,TENCHUCVU,MACV,TENCV
FROM CHUCVU,CONGVIEC
WHERE CHUCVU.MACHUCVU=CONGVIEC.MACHUCVU

ALTER TABLE CONGVIEC
ADD GHICHU1 NVARCHAR(30);

ALTER TABLE CONGVIEC
ADD GHICHU2 NVARCHAR(30);

ALTER TABLE CONGVIEC
ALTER COLUMN GHICHU1 NCHAR(30);

