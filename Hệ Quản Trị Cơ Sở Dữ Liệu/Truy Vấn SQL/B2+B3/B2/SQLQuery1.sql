CREATE DATABASE QL_NHANVIEN
ON PRIMARY(
NAME = BD_PRIMARY,
FILENAME='E:\LuuDuLieuSinhVien\2001230656_DangDoHoangPhi_B1\B2\bd_primary.mdf',
SIZE =3 MB,
MAXSIZE=10MB,
FILEGROWTH=10%
),
(
NAME = BD_SECOND1_1,
FILENAME='E:\LuuDuLieuSinhVien\2001230656_DangDoHoangPhi_B1\B2\DB_SECOND1_1.mdf',
SIZE =3 MB,
MAXSIZE=5MB,
FILEGROWTH=10%
),
(
NAME = BD_SECOND1_2,
FILENAME='E:\LuuDuLieuSinhVien\2001230656_DangDoHoangPhi_B1\B2\DB_SECOND1_2.mdf',
SIZE =3 MB,
MAXSIZE=5MB,
FILEGROWTH=5%
),
(
NAME = BD_SECOND1_3,
FILENAME='E:\LuuDuLieuSinhVien\2001230656_DangDoHoangPhi_B1\B2\DB_SECOND1_3.mdf',
SIZE =3 MB,
MAXSIZE=5MB,
FILEGROWTH=15%
)
LOG ON
(
NAME = BD_LOG,
FILENAME='E:\LuuDuLieuSinhVien\2001230656_DangDoHoangPhi_B1\B2\DB_Log.mdf',
SIZE =1 MB,
MAXSIZE=5MB,
FILEGROWTH=15%
)
USE QL_NHANVIEN

CREATE TABLE NHANVIEN(
MANV CHAR(10) NOT NULL,
HONV NVARCHAR(40),
TENNV NVARCHAR(50),
NGAYSINH DATE,
DIACHI NVARCHAR(50),
PHAI NVARCHAR(3),
LUONG FLOAT,
MANQL NVARCHAR(20),
PHONG NVARCHAR(20),
CONSTRAINT PK_MANV PRIMARY KEY(MANV)
)
CREATE TABLE PHONGBAN
(
MAPHONG CHAR(20) NOT NULL,
PHONG NVARCHAR(20),
TRPHONG NVARCHAR(30),
NGNHAMCHUC NVARCHAR(50),
CONSTRAINT PK_PHONGBAN PRIMARY KEY(MAPHONG)
)
CREATE TABLE DDPHONG
(
MAPHONG CHAR(20) NOT NULL,
DIADIEM NVARCHAR(50),
CONSTRAINT PK_DDPHONG PRIMARY KEY(MAPHONG),
CONSTRAINT FK_DDPHONG FOREIGN KEY(MAPHONG) REFERENCES PHONGBAN(MAPHONG)
)
CREATE TABLE DEAN
(
TENDA NVARCHAR(30),
MADA CHAR(10) NOT NULL,
DDIENDA NVARCHAR(40),
PHONG CHAR(10),
CONSTRAINT PK_DEAN PRIMARY KEY(MADA)
)
CREATE TABLE PHANCONG
(
MANV CHAR(10) NOT NULL,
SODA CHAR(10) NOT NULL,
THOIGIAN DATE,
CONSTRAINT PK_PHANCONG PRIMARY KEY(MANV,SODA),
CONSTRAINT FK_PHANCONG_MANV FOREIGN KEY (MANV) REFERENCES NHANVIEN(MANV)
)
CREATE TABLE THANNHAN
(
MANV CHAR(10) NOT NULL,
TENTN NVARCHAR(40),
PHAI NVARCHAR(3),
NGAYSINH DATE,
QUANHE NVARCHAR(10),
CONSTRAINT PK_THANNHAN PRIMARY KEY(MANV,TENTN),
CONSTRAINT FK_THANNHAN_MANV FOREIGN KEY (MANV) REFERENCES NHANVIEN(MANV)
)
INSERT INTO NHANVIEN VALUES
('NV001', N'Nguyễn',N'Ái','2000/12/1','Bình Tân',N'Nam',100,'QL001',N'Công nghệ'),
('NV002', N'Hà',N'Loan','2000/11/1','Bình Tân',N'Nữ',200,'QL002',N'Kế toán'),
('NV003', N'Lâm',N'Thị','2000/10/1','Bình Tân',N'Nam',300,'QL003',N'Kế toán'),
('NV004', N'Huỳnh',N'Nhật','2000/9/10','Bình Tân',N'Nữ',400,'QL004',N'Kế toán'),
('NV005', N'Dương',N'Hoàng','2000/8/10','Bình Tân',N'Nam',500,'QL005',N'Kế toán')
INSERT INTO PHONGBAN VALUES
('P001',N'Nhân sự',N'Hoàng',N'Hương'),
('P002',N'Kế toán',N'Lâm',N'Oanh'),
('P003',N'Hành chính',N'Hoàng',N'Hưng'),
('P004',N'Công nghệ',N'Hoàng',N'Huy'),
('P005',N'Nhân sự',N'Hoàng',N'Hiếu')
INSERT INTO DDPHONG VALUES
('P001',N'Bình Tân'),
('P002',N'Bình Tân'),
('P003',N'Bình Tân'),
('P004',N'Bình Tân'),
('P005',N'Bình Tân')
INSERT INTO DEAN VALUES
(N'KOP','DE001',N'BÌNH TÂN',N'2000/12/2'),
(N'KOP','DE002',N'BÌNH TÂN',N'2000/12/2'),
(N'KOP','DE003',N'BÌNH TÂN',N'2000/12/2'),
(N'KOP','DE004',N'BÌNH TÂN',N'2000/12/2'),
(N'KOP','DE005',N'BÌNH TÂN',N'2000/12/2')
INSERT INTO PHANCONG VALUES
('NV001','001','2012/3/12'),
('NV002','001','2012/3/12'),
('NV003','001','2012/3/12'),
('NV004','001','2012/3/12'),
('NV005','001','2012/3/12')
INSERT INTO THANNHAN VALUES
('NV001',N'HÀ',N'NAM','2000/5/5',N'CHA'),
('NV002',N'HÀ',N'NAM','2000/5/5',N'CHA'),
('NV003',N'HÀ',N'NAM','2000/5/5',N'CHA'),
('NV004',N'HÀ',N'NAM','2000/5/5',N'CHA'),
('NV005',N'HÀ',N'NAM','2000/5/5',N'CHA')

SELECT MANV,PHAI,PHONG
FROM NHANVIEN
WHERE PHONG='4'AND PHAI=N'NỮ'

SELECT MANV,TENNV,PHONG
FROM NHANVIEN
WHERE PHONG=N'Phòng số 4'

SELECT MANV,TENNV,LUONG
FROM NHANVIEN
WHERE LUONG BETWEEN 2000000 AND 10000000

SELECT MANV,TENNV,HONV
FROM NHANVIEN
WHERE HONV LIKE N'Nguyễn %'

SELECT MANV,MADA
FROM NHANVIEN NV, DEAN DA
WHERE NV.PHONG=DA.PHONG
ORDER BY MANV DESC

SELECT MANV,TENNV
FROM NHANVIEN
WHERE PHONG IN (
SELECT PHONG
FROM NHANVIEN
WHERE PHONG=N'TP HỒ CHÍ MINH'
)

SELECT MANV,TENNV
FROM NHANVIEN
WHERE MANV NOT IN (
SELECT MANV,TENTN
FROM NHANVIEN NV, THANNHAN TN
WHERE NV.MANV=TN.MANV
)

SELECT MANV, TENNV,LUONG
FROM NHANVIEN
WHERE LUONG >= ALL(
SELECT LUONG
FROM NHANVIEN
)

SELECT MANV,TENNV,NGAYSINH
FROM NHANVIEN
WHERE NGAYSINH<=ALL(
SELECT NGAYSINH
FROM NHANVIEN
)

SELECT COUNT(MANV) AS N'SỐ LƯỢNG NHÂN VIÊN'
FROM NHANVIEN
WHERE PHONG=N'PHÒNG NGHIÊN CỨU'

SELECT PB.PHONG,COUNT(MANV)AS N'SỐ LƯỢNG NHÂN VIÊN'
FROM NHANVIEN NV, PHONGBAN PB
WHERE NV.PHONG=PB.PHONG
GROUP BY PB.PHONG

SELECT PB.PHONG,COUNT(MANV)AS N'SỐ LƯỢNG NHÂN VIÊN'
FROM NHANVIEN NV, PHONGBAN PB
WHERE NV.PHONG=PB.PHONG
GROUP BY PB.PHONG
HAVING COUNT(MANV)>10